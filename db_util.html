<!DOCTYPE HTML>
<meta charset="UTF-8">
<head>
	<link rel="stylesheet" href="./styles/site.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="tableHelper.js"></script>
</head>
<html>
	<p> MySQL query string </p>
	<p>
		<input type='text' size='90'id='db_query_text'></input>
		<button id='db_submit' onclick="submitQuery()">Submit</button>
	</p>
	<p>
		DB Operations
	</p>
	<table>
		<tr><td><a href="http://www.pinckert.com/cgi-bin/db_util.py?cmd=show_tables">List</a></td><td>Show all builds</td></tr>
		<tr><td><a href="http://www.pinckert.com/cgi-bin/db_util.py?cmd=clear">Clear</a></td><td>Drop all of the tables</td></tr>
		<tr><td><a href="http://www.pinckert.com/cgi-bin/db_util.py?cmd=initialize">Initialize</a></td><td>Create the tables if they don't exist</td></tr>
		<tr><td><a href="http://www.pinckert.com/data_collection/xmltodb.py">Load Data</a></td><td>Load the data from the XML files</td></tr>
		<tr><td><a href="http://www.pinckert.com/cgi-bin/db_util.py?cmd=hack">Empty record hack</a></td><td>Remove superfluous records</td></tr>
	</table>
	<p id="result">
	</p>
</html>
<script>
function submitQuery() {
    text = document.getElementById("db_query_text").value;
	console.log(text);
	var jqxhr = $.get(encodeURI("http://www.pinckert.com/cgi-bin/db_test.py?" + text), function(data) {
		console.log("return for DB query");
		console.dir(jqxhr);
		console.dir(data);
		tab = tableFromDictArray(data);
		node = document.getElementById("result");
		while (node.firstChild) {
			node.removeChild(node.firstChild);
		}
		node.append(tab);
	}
	)
}
</script>